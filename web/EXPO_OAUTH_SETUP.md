# Expo OAuth Setup Guide

## Using Expo AuthSession for Google OAuth

This app now uses Expo's built-in `expo-auth-session` for OAuth, which handles redirects properly without needing ngrok.

## Step 1: Get Your Expo Redirect URI

The redirect URI will be automatically generated by Expo. It follows this pattern:

```
https://auth.expo.dev/@YOUR_EXPO_USERNAME/YOUR_APP_SLUG
```

To find your exact redirect URI:

1. Run the app and check the console logs when you click "Continue with Google"
2. Look for: `Expo redirect URI: https://auth.expo.dev/@username/matcher`
3. Copy that exact URL

Or check your `app.json`:
- `slug`: "matcher" (from app.json)
- `owner`: Your Expo username (run `npx expo whoami` to find it)

## Step 2: Add Redirect URI to Google Cloud Console

1. Go to: https://console.cloud.google.com/apis/credentials
2. Find your OAuth 2.0 Client ID
3. Click **Edit**
4. In **Authorized redirect URIs**, add:
   ```
   https://auth.expo.dev/@YOUR_EXPO_USERNAME/matcher
   ```
   (Replace `YOUR_EXPO_USERNAME` with your actual Expo username)
5. Click **Save**

## Step 3: Test

1. Restart your backend server
2. Try logging in with Google from the mobile app
3. Google should redirect to Expo's proxy, which then redirects back to your app

## How It Works

1. App uses `AuthSession.makeRedirectUri({ useProxy: true })` to get Expo's redirect URI
2. App creates OAuth request with that redirect URI
3. Google redirects to Expo's proxy (`https://auth.expo.dev/@username/matcher`)
4. Expo proxy redirects back to app with OAuth code
5. App sends code to backend to exchange for tokens and create session
6. App navigates to main/setup

## Troubleshooting

### "Invalid redirect_uri" error
- Make sure the redirect URI in Google Cloud Console matches exactly what Expo generates
- Check console logs for the exact redirect URI being used

### App doesn't receive OAuth code
- Make sure `expo-auth-session` is installed: `npm install expo-auth-session`
- Check that `WebBrowser.maybeCompleteAuthSession()` is called

